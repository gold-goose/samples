



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>.NET Primer &mdash; .NET Core Documentation 0.0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
    <link rel="top" title=".NET Core Documentation 0.0.1 documentation" href="../index.html"/>
        <link rel="up" title="The .NET Primer" href="index.html"/>
        <link rel="next" title="Tutorials &amp; Samples" href="../tutorials-samples/index.html"/>
        <link rel="prev" title="The .NET Primer" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> .NET Core Documentation
          

          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started/index.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">The .NET Primer</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">.NET Primer</a><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-samples/index.html">Tutorials &amp; Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/index.html">Developing using .NET Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../porting/index.html">Porting applications &amp; existing code to .NET Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../packaging/index.html">Packaging .NET Core Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/index.html">Deploying .NET Core applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nuget/index.html">.NET Package Manager (NuGet)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../languages/index.html">Programming languages on the .NET Platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bcl/index.html">Base Class Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../async/async-index.html">Asynchronous Programming with .NET</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Advanced topics</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">.NET Core Documentation</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">The .NET Primer</a> &raquo;</li>
      
    <li>.NET Primer</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/concepts/primer.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <noscript><img alt="" width="1" height="1" src="https://c.microsoft.com/trans_pixel.aspx"/></noscript><div class="section" id="net-primer">
<h1>.NET Primer<a class="headerlink" href="#net-primer" title="Permalink to this headline">¶</a></h1>
<p>By <a class="reference external" href="https://github.com/richlander">Rich Lander</a>, <a class="reference external" href="https://github.com/blackdwarf">Zlatko Knezevic</a></p>
<p>.NET is a general purpose development platform. It can be used for any
kind of app type or workload where general purpose solutions are used.
It has several key features that are attractive to many developers,
including automatic memory management and modern programming languages,
that make it easier to efficiently build high-quality apps. .NET enables
a high-level programming environment with many convenience features,
while providing low-level access to native memory and APIs.</p>
<p>Multiple implementations of .NET are available, based on open <a class="reference external" href="https://github.com/dotnet/coreclr/blob/master/Documentation/dotnet-standards.md">.NET
Standards</a> that specify the fundamentals of the
platform. They are separately optimized for different app types (e.g.
desktop, mobile, gaming, cloud) and support many chips (e.g. x86/x64,
ARM) and operating systems (e.g. Windows, Linux, iOS, Android, OS X).
Open source is also an important part of the .NET ecosystem, with
multiple .NET implementations and many libraries available under
OSI-approved licenses.</p>
<p>You can take a look at the <a class="reference internal" href="../getting-started/overview.html"><em>Overview of .NET implementations</em></a> document to figure out all of the different editions of .NET Framework that are available, both Microsoft&#8217;s and others.</p>
<div class="section" id="key-net-concepts">
<h2>Key .NET Concepts<a class="headerlink" href="#key-net-concepts" title="Permalink to this headline">¶</a></h2>
<p>There is a certain number of concepts that are very important to understand if you are new to the .NET Platform. These concepts are the cornerstone of the entire platform, and understanding them at the outset is important for general understanding of how .NET works.</p>
<ul class="simple">
<li><a class="reference internal" href="managed-code.html"><em>Managed Code</em></a></li>
<li><a class="reference internal" href="common-type-system.html"><em>Common Type System</em></a></li>
<li><a class="reference internal" href="common-language-runtime.html"><em>The runtime</em></a></li>
<li><a class="reference internal" href="framework-libraries.html"><em>Base Class Library</em></a></li>
</ul>
</div>
<div class="section" id="a-stroll-through-net">
<h2>A stroll through .NET<a class="headerlink" href="#a-stroll-through-net" title="Permalink to this headline">¶</a></h2>
<p>As any mature and advanced application development framework, .NET has many powerful features that make the developer&#8217;s job easier and aim to make writing code more powerful and expressive. This section will outline the basics of the most salient features and provide pointers to more detailed discussions where needed. After finishing this stroll, you should have enough information to be able to read the samples on our GitHub repos as well as other code and understand what is going on.</p>
<ul class="simple">
<li><a class="reference internal" href="#automatic-memory-management">Automatic memory management</a></li>
<li><a class="reference internal" href="#type-safety">Type safety</a></li>
<li>The managed compiler</li>
<li><a class="reference internal" href="#delegates-and-lambdas">Delegates and lambdas</a></li>
<li><a class="reference internal" href="#generic-types-generics">Generic Types (Generics)</a></li>
<li><a class="reference internal" href="#language-integrated-query-linq">Language Integrated Query (LINQ)</a></li>
<li><a class="reference internal" href="#async-programming">Async Programming</a></li>
<li>Dynamic language features</li>
<li>Code contracts</li>
<li><a class="reference internal" href="#native-interoperability">Native interoperability</a></li>
<li><a class="reference internal" href="#unsafe-code">Unsafe Code</a></li>
</ul>
<div class="section" id="automatic-memory-management">
<h3>Automatic memory management<a class="headerlink" href="#automatic-memory-management" title="Permalink to this headline">¶</a></h3>
<p>Garbage collection is the most well-known of .NET features. Developers do not need to actively manage memory, although there are affordances to provide more information to the garbage collector (GC). C# includes the  <code class="docutils literal"><span class="pre">new</span></code>  keyword to allocate memory in terms of a particular type, and the  <code class="docutils literal"><span class="pre">using</span></code>  keyword to provide scope for the usage of the object. The GC operates on a lazy approach to memory management, preferring application throughput to the immediate collection of memory.</p>
<p>The following two lines both allocate memory:</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="kt">var</span> <span class="n">title</span> <span class="p">=</span> <span class="s">&quot;.NET Primer&quot;</span><span class="p">;</span>
<span class="kt">var</span> <span class="n">list</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;;</span>
</pre></div>
</div>
<p>There is no analogous keyword to de-allocate memory, as de-allocation happens automatically when the garbage collector reclaims the memory through its scheduled running.</p>
<p>Method variables normally go out of scope once a method completes, at which point they can be collected. However, you can indicate to the GC that a particular object is out of scope sooner than method exit using the <code class="docutils literal"><span class="pre">using</span></code> statement.</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="n">using</span><span class="p">(</span><span class="n">FileStream</span> <span class="n">stream</span> <span class="p">=</span> <span class="n">GetFileStream</span><span class="p">(</span><span class="n">context</span><span class="p">))</span>
<span class="p">{</span>
    <span class="c1">//operations on the stream</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Once the <code class="docutils literal"><span class="pre">using</span></code> block completes, the GC will know that the <code class="docutils literal"><span class="pre">stream</span></code> object in the example above is free to be collected and its memory reclaimed.</p>
<p>One of the less obvious but quite far-reaching features that a garbage
collector enables is memory safety. The invariant of memory safety is
very simple: a program is memory safe if it accesses only memory that
has been allocated (and not freed). Dangling pointers are always bugs,
and tracking them down is often quite difficult.</p>
<p>The .NET runtime provides additional services, to complete the promise
of memory safety, not naturally offered by a GC. It ensures that
programs do not index off the end of an array or accessing a phantom
field off the end of an object.</p>
<p>The following example will throw as a result of memory safety.</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="kt">int</span><span class="p">[]</span> <span class="n">numbers</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="p">[</span><span class="m">42</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">number</span> <span class="p">=</span> <span class="n">numbers</span><span class="p">[</span><span class="m">42</span><span class="p">];</span> <span class="c1">// will throw (indexes are 0-based)</span>
</pre></div>
</div>
</div>
<div class="section" id="type-safety">
<h3>Type Safety<a class="headerlink" href="#type-safety" title="Permalink to this headline">¶</a></h3>
<p>Objects are allocated in terms of types. The only operations allowed for
a given object, and the memory it consumes, are those of its type. A
<code class="docutils literal"><span class="pre">Dog</span></code> type may have <code class="docutils literal"><span class="pre">Jump</span></code> and <code class="docutils literal"><span class="pre">WagTail</span></code> methods, but not likely a
<code class="docutils literal"><span class="pre">SumTotal</span></code> method. A program can only call the declared methods of a
given type. All other calls will result either in a compile-time error or a
run-time exception (in case of using dynamic features or <code class="docutils literal"><span class="pre">object</span></code>).</p>
<p>.NET languages can be object-oriented, with hierarchies of base and
derived classes. The .NET runtime will only allow object casts and calls
that align with the object hierarchy. Remember that every type defined in any
.NET language derives from the core <code class="docutils literal"><span class="pre">object</span></code> type.</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="n">Dog</span> <span class="n">dog</span> <span class="p">=</span> <span class="n">Dog</span><span class="p">.</span><span class="n">AdoptDog</span><span class="p">();</span> <span class="c1">// Returns a Dog type</span>
<span class="n">Pet</span> <span class="n">pet</span> <span class="p">=</span> <span class="p">(</span><span class="n">Pet</span><span class="p">)</span><span class="n">dog</span><span class="p">;</span> <span class="c1">// Dog derives from Pet</span>
<span class="n">pet</span><span class="p">.</span><span class="n">ActCute</span><span class="p">();</span>
<span class="n">Car</span> <span class="n">car</span> <span class="p">=</span> <span class="p">(</span><span class="n">Car</span><span class="p">)</span><span class="n">dog</span><span class="p">;</span> <span class="c1">// will throw - no relationship between Car and Dog</span>
<span class="kt">object</span> <span class="n">temp</span> <span class="p">=</span> <span class="p">(</span><span class="kt">object</span><span class="p">)</span><span class="n">dog</span><span class="p">;</span> <span class="c1">// legal - a Dog is an object</span>
<span class="n">car</span> <span class="p">=</span> <span class="p">(</span><span class="n">Car</span><span class="p">)</span><span class="n">temp</span><span class="p">;</span> <span class="c1">// will throw - the runtime isn&#39;t fooled</span>
<span class="n">car</span><span class="p">.</span><span class="n">Accelerate</span><span class="p">()</span> <span class="c1">// the dog won&#39;t like this, nor will the program get this far</span>
</pre></div>
</div>
<p>Type safety is also used to help enforce encapsulation by guaranteeing the fidelity
of the accessor keywords. Accessor keywords are artifacts which control access to
members of a given type by other code. These are usually used for various kinds
of data within a type that are used to manage its behavior.</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="n">Dog</span> <span class="n">dog</span> <span class="p">=</span> <span class="n">Dog</span><span class="p">.</span><span class="n">_nextDogToBeAdopted</span><span class="p">;</span> <span class="c1">// will throw - this is a private field</span>
</pre></div>
</div>
<p>Some .NET languages support <strong>type inference</strong>. Type inference means that the compiler
will deduce the type of the expression on the left-hand side from the expression on the
right-hand side. This doesn&#8217;t mean that the type safety is broken or avoided. The resulting
type <strong>has</strong> a strong type with everything that implies. Let&#8217;s rewrite the first two lines
of the previous example to introduce type inference. You will note that the rest of
the example is completely the same.</p>
<div class="highlight-c#"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre>  <span class="kt">var</span> <span class="n">dog</span> <span class="p">=</span> <span class="n">Dog</span><span class="p">.</span><span class="n">AdoptDog</span><span class="p">();</span>
  <span class="kt">var</span> <span class="n">pet</span> <span class="p">=</span> <span class="p">(</span><span class="n">Pet</span><span class="p">)</span><span class="n">dog</span><span class="p">;</span>
  <span class="n">pet</span><span class="p">.</span><span class="n">ActCute</span><span class="p">();</span>
  <span class="n">Car</span> <span class="n">car</span> <span class="p">=</span> <span class="p">(</span><span class="n">Car</span><span class="p">)</span><span class="n">dog</span><span class="p">;</span> <span class="c1">// will throw - no relationship between Car and Dog</span>
  <span class="kt">object</span> <span class="n">temp</span> <span class="p">=</span> <span class="p">(</span><span class="kt">object</span><span class="p">)</span><span class="n">dog</span><span class="p">;</span> <span class="c1">// legal - a Dog is an object</span>
  <span class="n">car</span> <span class="p">=</span> <span class="p">(</span><span class="n">Car</span><span class="p">)</span><span class="n">temp</span><span class="p">;</span> <span class="c1">// will throw - the runtime isn&#39;t fooled</span>
  <span class="n">car</span><span class="p">.</span><span class="n">Accelerate</span><span class="p">()</span> <span class="c1">// the dog won&#39;t like this, nor will the program get this far</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="delegates-and-lambdas">
<h3>Delegates and Lambdas<a class="headerlink" href="#delegates-and-lambdas" title="Permalink to this headline">¶</a></h3>
<p>Delegates are like C++ function pointers, with a big difference that they are type safe. They are a
kind of disconnected method within the CLR type system. Regular methods
are attached to a class and only directly callable through static or
instance calling conventions.</p>
<p>Delegates are used in various APIs and places in the .NET world, especially through lambda expressions, which are a cornerstone of Linq.</p>
<p>Read more about it in the <a class="reference internal" href="delegates-lambdas.html"><em>Delegates and lambdas</em></a> document.</p>
</div>
<div class="section" id="generic-types-generics">
<h3>Generic Types (Generics)<a class="headerlink" href="#generic-types-generics" title="Permalink to this headline">¶</a></h3>
<p>Generic types, a.k.a &#8220;generics&#8221; are a feature that was added in .NET Framework 2.0. In short, generics allow the programmer to introduce a &#8220;type parameter&#8221; when designing their classes, that will allow the client code (i.e. the users of the type) to specify the exact type to use in place of the type parameter.</p>
<p>Generics were added in order to help programmers implement generic data structures. Before their arrival, in order for a, say, <cite>List</cite> type to be generic, it would have to work with elements that were of type <cite>object</cite>. This would have various performance as well as semantic problems, not to mention possible subtle runtime errors. The most notorious of the latter is when a data structure contains, for instance, both integers and strings, and an <cite>InvalidCastException</cite> is thrown on working with the list&#8217;s members.</p>
<p>The below sample shows a basic program running using an instance of <cite>List&lt;T&gt;</cite> types.</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">GenericsSampleShort</span> <span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">){</span>
        <span class="c1">// List&lt;string&gt; is the client way of specifying the actual type for the type parameter T</span>
        <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="n">listOfStrings</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;</span> <span class="p">{</span> <span class="s">&quot;First&quot;</span><span class="p">,</span> <span class="s">&quot;Second&quot;</span><span class="p">,</span> <span class="s">&quot;Third&quot;</span> <span class="p">};</span>

        <span class="c1">// listOfStrings can accept only strings, both on read and write.</span>
        <span class="n">listOfStrings</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="s">&quot;Fourth&quot;</span><span class="p">);</span>

        <span class="c1">// Below will throw a compile-time error, since the type parameter</span>
        <span class="c1">// specifies this list as containing only strings.</span>
        <span class="n">listOfStrings</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">);</span>

    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Read more about it in the <a class="reference internal" href="generics.html"><em>Generic Types (Generics) Overview</em></a> document.</p>
</div>
<div class="section" id="async-programming">
<h3>Async Programming<a class="headerlink" href="#async-programming" title="Permalink to this headline">¶</a></h3>
<p>Async programming is a first-class concept within .NET, with async support in the
runtime, the framework libraries, and .NET language constructs.  Internally, they are based off of objects (such as <code class="docutils literal"><span class="pre">Task</span></code>) which take advantage of the operating system to perform I/O-bound jobs as efficiently as possible.</p>
<p>To learn more about async programming in .NET, start with the <a class="reference internal" href="../async/async-overview.html"><em>Async Overview</em></a>.</p>
</div>
<div class="section" id="language-integrated-query-linq">
<h3>Language Integrated Query (LINQ)<a class="headerlink" href="#language-integrated-query-linq" title="Permalink to this headline">¶</a></h3>
<p>LINQ is a powerful set of features for C# and VB that allow you to write simple, declarative code for operating on data.  The data can be in many forms (such as in-memory objects, in a SQL database, or an XML document), but the LINQ code you write typically won&#8217;t look different for each data source!</p>
<p>To learn more and see some samples, check out <a class="reference internal" href="linq.html"><em>LINQ (Language Integrated Query)</em></a>.</p>
</div>
<div class="section" id="dynamic-language-features">
<h3>Dynamic language features<a class="headerlink" href="#dynamic-language-features" title="Permalink to this headline">¶</a></h3>
<p>TODO: finish section</p>
</div>
<div class="section" id="code-contracts">
<h3>Code contracts<a class="headerlink" href="#code-contracts" title="Permalink to this headline">¶</a></h3>
<p>TODO: finish section</p>
</div>
<div class="section" id="native-interoperability">
<h3>Native Interoperability<a class="headerlink" href="#native-interoperability" title="Permalink to this headline">¶</a></h3>
<p>Every operating system in current use provides a lot of platform support for
various programming tasks. .NET provides several ways to tap into those APIs.
Collectively, this support is called &#8220;native interoperability&#8221; and in this
section we will take a look at how to access native APIs from managed, .NET
code.</p>
<p>The main way to do native interoperability is via &#8220;platform invoke&#8221; or P/Invoke
for short. This support in .NET Core is available across Linux and Windows
platforms. Another, Windows-only way of doing native interoperability is known
as &#8220;COM interop&#8221;. It&#8217;s main goal is to allow using
<a class="reference external" href="https://msdn.microsoft.com/en-us/library/bwa2bx93.aspx">COM components</a>
in managed code. It is built on top of P/Invoke infrastructure, but it works in
subtly different ways.</p>
<p>Most of Mono&#8217;s (and thus Xamarin&#8217;s) interoperability support for Java and
Objective-C are built similarly, that is, they use the same principles.</p>
<p>Read more about it in the <a class="reference internal" href="native-interop.html"><em>Native interoperability</em></a> document.</p>
</div>
<div class="section" id="unsafe-code">
<h3>Unsafe Code<a class="headerlink" href="#unsafe-code" title="Permalink to this headline">¶</a></h3>
<p>The CLR enables the ability to access native memory and do pointer
arithmetic via <code class="docutils literal"><span class="pre">unsafe</span></code> code. These operations are needed for certain algorithms and system interoperability.  Although powerful, use of unsafe code is discouraged unless it is necessary to interop with system APIs or implement the most efficient algorithm.  Unsafe code may not execute the same way in different environments, and also loses the benefits of a garbage collector and type safety.  It&#8217;s recommended to confine and centralize unsafe code as much as possible, and test that code thoroughly.</p>
<p>The <code class="docutils literal"><span class="pre">ToString()</span></code> method from the <a class="reference external" href="https://github.com/dotnet/coreclr/blob/master/src/mscorlib/src/System/Text/StringBuilder.cs#L327">StringBuilder class</a>. illustrates how using <code class="docutils literal"><span class="pre">unsafe</span></code> code can efficiently implement an algorithm by moving around chunks of memory directly:</p>
<div class="highlight-c#"><div class="highlight"><pre><span class="k">public</span> <span class="k">override</span> <span class="n">String</span> <span class="nf">ToString</span><span class="p">()</span> <span class="p">{</span>
          <span class="n">Contract</span><span class="p">.</span><span class="n">Ensures</span><span class="p">(</span><span class="n">Contract</span><span class="p">.</span><span class="n">Result</span><span class="p">&lt;</span><span class="n">String</span><span class="p">&gt;()</span> <span class="p">!=</span> <span class="k">null</span><span class="p">);</span>

          <span class="n">VerifyClassInvariant</span><span class="p">();</span>

          <span class="k">if</span> <span class="p">(</span><span class="n">Length</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
              <span class="k">return</span> <span class="n">String</span><span class="p">.</span><span class="n">Empty</span><span class="p">;</span>

          <span class="kt">string</span> <span class="n">ret</span> <span class="p">=</span> <span class="kt">string</span><span class="p">.</span><span class="n">FastAllocateString</span><span class="p">(</span><span class="n">Length</span><span class="p">);</span>
          <span class="n">StringBuilder</span> <span class="n">chunk</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span>
          <span class="k">unsafe</span> <span class="p">{</span>
              <span class="k">fixed</span> <span class="p">(</span><span class="kt">char</span><span class="p">*</span> <span class="n">destinationPtr</span> <span class="p">=</span> <span class="n">ret</span><span class="p">)</span>
              <span class="p">{</span>
                  <span class="k">do</span>
                  <span class="p">{</span>
                      <span class="k">if</span> <span class="p">(</span><span class="n">chunk</span><span class="p">.</span><span class="n">m_ChunkLength</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                      <span class="p">{</span>
                          <span class="c1">// Copy these into local variables so that they are stable even in the presence of ----s (hackers might do this)</span>
                          <span class="kt">char</span><span class="p">[]</span> <span class="n">sourceArray</span> <span class="p">=</span> <span class="n">chunk</span><span class="p">.</span><span class="n">m_ChunkChars</span><span class="p">;</span>
                          <span class="kt">int</span> <span class="n">chunkOffset</span> <span class="p">=</span> <span class="n">chunk</span><span class="p">.</span><span class="n">m_ChunkOffset</span><span class="p">;</span>
                          <span class="kt">int</span> <span class="n">chunkLength</span> <span class="p">=</span> <span class="n">chunk</span><span class="p">.</span><span class="n">m_ChunkLength</span><span class="p">;</span>

                          <span class="c1">// Check that we will not overrun our boundaries.</span>
                          <span class="k">if</span> <span class="p">((</span><span class="kt">uint</span><span class="p">)(</span><span class="n">chunkLength</span> <span class="p">+</span> <span class="n">chunkOffset</span><span class="p">)</span> <span class="p">&lt;=</span> <span class="n">ret</span><span class="p">.</span><span class="n">Length</span> <span class="p">&amp;&amp;</span> <span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="n">chunkLength</span> <span class="p">&lt;=</span> <span class="p">(</span><span class="kt">uint</span><span class="p">)</span><span class="n">sourceArray</span><span class="p">.</span><span class="n">Length</span><span class="p">)</span>
                          <span class="p">{</span>
                              <span class="k">fixed</span> <span class="p">(</span><span class="kt">char</span><span class="p">*</span> <span class="n">sourcePtr</span> <span class="p">=</span> <span class="n">sourceArray</span><span class="p">)</span>
                                  <span class="kt">string</span><span class="p">.</span><span class="n">wstrcpy</span><span class="p">(</span><span class="n">destinationPtr</span> <span class="p">+</span> <span class="n">chunkOffset</span><span class="p">,</span> <span class="n">sourcePtr</span><span class="p">,</span> <span class="n">chunkLength</span><span class="p">);</span>
                          <span class="p">}</span>
                          <span class="k">else</span>
                          <span class="p">{</span>
                              <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArgumentOutOfRangeException</span><span class="p">(</span><span class="s">&quot;chunkLength&quot;</span><span class="p">,</span> <span class="n">Environment</span><span class="p">.</span><span class="n">GetResourceString</span><span class="p">(</span><span class="s">&quot;ArgumentOutOfRange_Index&quot;</span><span class="p">));</span>
                          <span class="p">}</span>
                      <span class="p">}</span>
                      <span class="n">chunk</span> <span class="p">=</span> <span class="n">chunk</span><span class="p">.</span><span class="n">m_ChunkPrevious</span><span class="p">;</span>
                  <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">chunk</span> <span class="p">!=</span> <span class="k">null</span><span class="p">);</span>
              <span class="p">}</span>
          <span class="p">}</span>
          <span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
      <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<p>The term &#8221;.NET runtime&#8221; is used throughout the document to accommodate
for the multiple implementations of .NET, such as CLR, Mono, IL2CPP and
others. The more specific names are only used if needed.</p>
<p>This document is not intended to be historical in nature, but describe
the .NET platform as it is now. It isn&#8217;t important whether a .NET
feature has always been available or was only recently introduced, only
that it is important enough to highlight and discuss.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../tutorials-samples/index.html" class="btn btn-neutral float-right" title="Tutorials &amp; Samples" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="The .NET Primer" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Microsoft.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>